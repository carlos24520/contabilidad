<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Sistema Contable</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow-lg">
        <div class="card-header bg-primary text-white">
            <h3 class="text-center">Sistema Contable - Libro Diario</h3>
        </div>

        <div class="card-body">

            <!-- FORMULARIO -->
            <form id="formContable">
                <div class="row mb-3">

                    <div class="col-md-3">
                        <label class="form-label">Fecha</label>
                        <input type="date" id="fecha" class="form-control" required>
                    </div>

                    <div class="col-md-3">
                        <label class="form-label">Concepto</label>
                        <input type="text" id="concepto" class="form-control" placeholder="Ej: Pago arriendo" required>
                    </div>

                    <div class="col-md-3">
                        <label class="form-label">Monto</label>
                        <input type="number" id="monto" class="form-control" placeholder="0" required>
                    </div>

                    <div class="col-md-3">
                        <label class="form-label">Tipo</label>
                        <select id="tipo" class="form-select" required>
                            <option value="">Seleccione</option>
                            <option value="Ingreso">Ingreso</option>
                            <option value="Egreso">Egreso</option>
                        </select>
                    </div>

                </div>

                <button type="submit" class="btn btn-success w-100">
                    Registrar Movimiento
                </button>
            </form>

            <hr>

            <!-- TABLA -->
            <div class="table-responsive">
                <table class="table table-bordered table-striped mt-3">
                    <thead class="table-dark text-center">
                        <tr>
                            <th>Fecha</th>
                            <th>Concepto</th>
                            <th>Ingreso</th>
                            <th>Egreso</th>
                            <th>Eliminar</th>
                        </tr>
                    </thead>
                    <tbody id="tablaMovimientos">
                    </tbody>
                </table>
            </div>

            <hr>

            <!-- RESUMEN -->
            <div class="row text-center">
                <div class="col-md-4">
                    <h5>Total Ingresos</h5>
                    <h4 class="text-success" id="totalIngresos">$0</h4>
                </div>
                <div class="col-md-4">
                    <h5>Total Egresos</h5>
                    <h4 class="text-danger" id="totalEgresos">$0</h4>
                </div>
                <div class="col-md-4">
                    <h5>Saldo</h5>
                    <h4 class="text-primary" id="saldo">$0</h4>
                </div>
            </div>

        </div>
    </div>
</div>

<script>
let movimientos = JSON.parse(localStorage.getItem("movimientos")) || [];

const form = document.getElementById("formContable");
const tabla = document.getElementById("tablaMovimientos");

form.addEventListener("submit", function(e) {
    e.preventDefault();

    const fecha = document.getElementById("fecha").value;
    const concepto = document.getElementById("concepto").value;
    const monto = parseFloat(document.getElementById("monto").value);
    const tipo = document.getElementById("tipo").value;

    const movimiento = { fecha, concepto, monto, tipo };
    movimientos.push(movimiento);

    localStorage.setItem("movimientos", JSON.stringify(movimientos));

    form.reset();
    mostrarMovimientos();
});

function mostrarMovimientos() {
    tabla.innerHTML = "";
    let totalIngresos = 0;
    let totalEgresos = 0;

    movimientos.forEach((mov, index) => {
        const fila = document.createElement("tr");

        let ingreso = "";
        let egreso = "";

        if (mov.tipo === "Ingreso") {
            ingreso = "$" + mov.monto.toLocaleString();
            totalIngresos += mov.monto;
        } else {
            egreso = "$" + mov.monto.toLocaleString();
            totalEgresos += mov.monto;
        }

        fila.innerHTML = `
            <td>${mov.fecha}</td>
            <td>${mov.concepto}</td>
            <td class="text-success">${ingreso}</td>
            <td class="text-danger">${egreso}</td>
            <td class="text-center">
                <button class="btn btn-sm btn-danger" onclick="eliminarMovimiento(${index})">X</button>
            </td>
        `;

        tabla.appendChild(fila);
    });

    document.getElementById("totalIngresos").textContent = "$" + totalIngresos.toLocaleString();
    document.getElementById("totalEgresos").textContent = "$" + totalEgresos.toLocaleString();
    document.getElementById("saldo").textContent = "$" + (totalIngresos - totalEgresos).toLocaleString();
}

function eliminarMovimiento(index) {
    movimientos.splice(index, 1);
    localStorage.setItem("movimientos", JSON.stringify(movimientos));
    mostrarMovimientos();
}

mostrarMovimientos();
</script>

</body>
</html>